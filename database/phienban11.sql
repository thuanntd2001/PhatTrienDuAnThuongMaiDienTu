-- MySQL Script generated by MySQL Workbench
-- Wed 01 Mar 2023 05:12:58 PM +07
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
-- -----------------------------------------------------
-- Schema KINHDOANHIOT
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `KINHDOANHIOT` ;

-- -----------------------------------------------------
-- Schema KINHDOANHIOT
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `KINHDOANHIOT` ;
USE `KINHDOANHIOT` ;

-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`CHUCVU`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`CHUCVU` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`CHUCVU` (
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `TENCHUCVU` VARCHAR(30) CHARACTER SET 'utf8mb3' NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB
AUTO_INCREMENT = 7
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`NHANVIEN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`NHANVIEN` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`NHANVIEN` (
  `MANV` BIGINT NOT NULL AUTO_INCREMENT,
  `HOTEN` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `NGAYSINH` DATE NOT NULL,
  `GIOITINH` BIT(1) NOT NULL DEFAULT b'1',
  `LUONG` INT NOT NULL,
  `SDT` VARCHAR(10) NOT NULL,
  `CMND` VARCHAR(15) NOT NULL,
  `DIACHI` VARCHAR(50) CHARACTER SET 'utf8mb3' NULL DEFAULT NULL,
  `NGAYVAOLAM` DATE NOT NULL,
  `TRANGTHAI` INT NOT NULL DEFAULT '0' COMMENT '1 hoat dong\\n0 ban\\n',
  PRIMARY KEY (`MANV`))
ENGINE = InnoDB
AUTO_INCREMENT = 25
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`PHIEUNHAP`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`PHIEUNHAP` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`PHIEUNHAP` (
  `MAPN` BIGINT NOT NULL AUTO_INCREMENT,
  `NHACC` VARCHAR(45) NOT NULL DEFAULT '0',
  `NGAY` DATETIME NOT NULL,
  `MANV` BIGINT NOT NULL,
  `TINHTRANG` INT NOT NULL DEFAULT 1,
  PRIMARY KEY (`MAPN`),
  INDEX `fk_PHIEUNHAP_NHANVIEN1_idx` (`MANV` ASC) VISIBLE,
  CONSTRAINT `fk_PHIEUNHAP_NHANVIEN1`
    FOREIGN KEY (`MANV`)
    REFERENCES `KINHDOANHIOT`.`NHANVIEN` (`MANV`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`LOAISP`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`LOAISP` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`LOAISP` (
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `TENLOAI` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`SANPHAM`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`SANPHAM` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`SANPHAM` (
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `TEN` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `LOAI` BIGINT NOT NULL,
  `GIA` INT NOT NULL,
  `DONVITINH` VARCHAR(45) NOT NULL DEFAULT 'CÃ¡i',
  `SOLUONGTON` INT NOT NULL DEFAULT '0',
  `ICON` VARCHAR(255) NOT NULL DEFAULT 'logo.webp',
  `TRANGTHAI` INT NOT NULL DEFAULT 0,
  PRIMARY KEY (`ID`),
  INDEX `FK_THUCDON_LOAITHUCUONG` (`LOAI` ASC) VISIBLE,
  CONSTRAINT `FK_THUCDON_LOAITHUCUONG`
    FOREIGN KEY (`LOAI`)
    REFERENCES `KINHDOANHIOT`.`LOAISP` (`ID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`CTPN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`CTPN` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`CTPN` (
  `MAPN` BIGINT NOT NULL,
  `SANPHAM` BIGINT NOT NULL,
  `SOLUONG` INT NOT NULL,
  `DONGIA` INT NOT NULL,
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID`),
  INDEX `fk_CTPN_PHIEUNHAP1_idx` (`MAPN` ASC) VISIBLE,
  INDEX `fk_CTPN_SANPHAM1_idx` (`SANPHAM` ASC) VISIBLE,
  CONSTRAINT `fk_CTPN_PHIEUNHAP1`
    FOREIGN KEY (`MAPN`)
    REFERENCES `KINHDOANHIOT`.`PHIEUNHAP` (`MAPN`),
  CONSTRAINT `fk_CTPN_SANPHAM1`
    FOREIGN KEY (`SANPHAM`)
    REFERENCES `KINHDOANHIOT`.`SANPHAM` (`ID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`KHACHHANG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`KHACHHANG` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`KHACHHANG` (
  `MAKH` BIGINT NOT NULL AUTO_INCREMENT,
  `HOTEN` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `NGAYSINH` DATE NULL,
  `GIOITINH` BIT(1) NULL DEFAULT b'1',
  `SDT` VARCHAR(10) NOT NULL,
  `DIACHI` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `TRANGTHAI` INT NOT NULL DEFAULT '1' COMMENT '1 Hoat dong\\n0 BAN\\n',
  PRIMARY KEY (`MAKH`))
ENGINE = InnoDB
AUTO_INCREMENT = 25
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`DONDATHANG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`DONDATHANG` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`DONDATHANG` (
  `MADDH` BIGINT NOT NULL AUTO_INCREMENT,
  `NGAYTHUCHIEN` DATETIME NOT NULL,
  `NVXACNHAN` BIGINT NULL DEFAULT NULL,
  `TINHTRANG` INT NOT NULL DEFAULT '0' COMMENT '0 dang cho xac nhan\\n1 da xac nhan\\n2 dang chuan bi hang\\n3 dang van chuyen\\n4 giao hang thanh cong \\n-1 da huy\\n-2 doi tra\\n',
  `MAKH` BIGINT NOT NULL,
  PRIMARY KEY (`MADDH`),
  INDEX `FK_HOADON_NHANVIEN` (`NVXACNHAN` ASC) VISIBLE,
  INDEX `fk_DONDATHANG_KHACHHANG1_idx` (`MAKH` ASC) VISIBLE,
  CONSTRAINT `fk_DONDATHANG_KHACHHANG1`
    FOREIGN KEY (`MAKH`)
    REFERENCES `KINHDOANHIOT`.`KHACHHANG` (`MAKH`),
  CONSTRAINT `FK_HOADON_NHANVIEN`
    FOREIGN KEY (`NVXACNHAN`)
    REFERENCES `KINHDOANHIOT`.`NHANVIEN` (`MANV`)
    ON UPDATE RESTRICT)
ENGINE = InnoDB
AUTO_INCREMENT = 58
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`NHAN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`NHAN` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`NHAN` (
  `TENNHAN` VARCHAR(255) NOT NULL,
  `NGAYTAO` DATE NOT NULL,
  `NVTAO` BIGINT NOT NULL,
  `NVSUA` BIGINT NULL,
  PRIMARY KEY (`TENNHAN`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`NHAN_SANPHAM`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`NHAN_SANPHAM` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`NHAN_SANPHAM` (
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `SANPHAM_ID` BIGINT NOT NULL,
  `TENNHAN` VARCHAR(255) NOT NULL,
  `NGAYTAO` DATE NOT NULL,
  `NVTAO` BIGINT NOT NULL,
  `NVSUA` BIGINT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_NHAN_has_SANPHAM_SANPHAM1_idx` (`SANPHAM_ID` ASC) VISIBLE,
  INDEX `fk_NHAN_SANPHAM_NHAN1_idx` (`TENNHAN` ASC) VISIBLE,
  CONSTRAINT `fk_NHAN_has_SANPHAM_SANPHAM1`
    FOREIGN KEY (`SANPHAM_ID`)
    REFERENCES `KINHDOANHIOT`.`SANPHAM` (`ID`),
  CONSTRAINT `fk_NHAN_SANPHAM_NHAN1`
    FOREIGN KEY (`TENNHAN`)
    REFERENCES `KINHDOANHIOT`.`NHAN` (`TENNHAN`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`TUKHOA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`TUKHOA` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`TUKHOA` (
  `TENTUKHOA` VARCHAR(255) NOT NULL,
  `NGAYTAO` DATE NOT NULL,
  `NVTAO` BIGINT NOT NULL,
  `NVSUA` BIGINT NULL,
  PRIMARY KEY (`TENTUKHOA`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`TUKHOA_NHAN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`TUKHOA_NHAN` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`TUKHOA_NHAN` (
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `TENTUKHOA` VARCHAR(255) NOT NULL,
  `TENNHAN` VARCHAR(255) NOT NULL,
  `NGAYTAO` DATE NOT NULL,
  `NVTAO` BIGINT NOT NULL,
  `NVSUA` BIGINT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_TUKHOA_NHAN_TUKHOA1_idx` (`TENTUKHOA` ASC) VISIBLE,
  INDEX `fk_TUKHOA_NHAN_NHAN1_idx` (`TENNHAN` ASC) VISIBLE,
  CONSTRAINT `fk_TUKHOA_NHAN_TUKHOA1`
    FOREIGN KEY (`TENTUKHOA`)
    REFERENCES `KINHDOANHIOT`.`TUKHOA` (`TENTUKHOA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TUKHOA_NHAN_NHAN1`
    FOREIGN KEY (`TENNHAN`)
    REFERENCES `KINHDOANHIOT`.`NHAN` (`TENNHAN`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`USER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`USER` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`USER` (
  `USERNAME` VARCHAR(20) NOT NULL,
  `PASSWD` VARCHAR(50) NOT NULL,
  `MANV` BIGINT NOT NULL,
  `ROLEID` BIGINT NOT NULL,
  `STATUS` INT NOT NULL,
  `EMAIL` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL DEFAULT 'n19dccn000@studen.ptithcm.edu.vn',
  `ICON` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL DEFAULT 'lo_highland.png',
  PRIMARY KEY (`USERNAME`),
  INDEX `FK_USERTB_CHUCVU` (`ROLEID` ASC) VISIBLE,
  INDEX `FK_USERTB_NHANVIEN` (`MANV` ASC) VISIBLE,
  CONSTRAINT `FK_USERTB_CHUCVU`
    FOREIGN KEY (`ROLEID`)
    REFERENCES `KINHDOANHIOT`.`CHUCVU` (`ID`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_USER_NHANVIEN1`
    FOREIGN KEY (`MANV`)
    REFERENCES `KINHDOANHIOT`.`NHANVIEN` (`MANV`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`USERKH`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`USERKH` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`USERKH` (
  `USERNAME` VARCHAR(20) NOT NULL,
  `PASSWD` VARCHAR(50) NOT NULL,
  `MAKH` BIGINT NOT NULL,
  `ROLEID` BIGINT NOT NULL,
  `STATUS` INT NOT NULL,
  `EMAIL` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL DEFAULT 'n19dccn000@studen.ptithcm.edu.vn',
  `ICON` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL DEFAULT 'lo_highland.png',
  PRIMARY KEY (`USERNAME`),
  INDEX `FK_USERTB_CHUCVU` (`ROLEID` ASC) VISIBLE,
  INDEX `fk_USERKH_KHACHHANG1_idx` (`MAKH` ASC) VISIBLE,
  CONSTRAINT `FK_USERTB_CHUCVU0`
    FOREIGN KEY (`ROLEID`)
    REFERENCES `KINHDOANHIOT`.`CHUCVU` (`ID`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_USERKH_KHACHHANG1`
    FOREIGN KEY (`MAKH`)
    REFERENCES `KINHDOANHIOT`.`KHACHHANG` (`MAKH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`CTDDH`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`CTDDH` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`CTDDH` (
  `MADDH` BIGINT NOT NULL,
  `SANPHAM` BIGINT NOT NULL,
  `SOLUONG` INT NOT NULL DEFAULT '0',
  `TONGTIEN` INT NOT NULL,
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `DIEM` INT NOT NULL DEFAULT 0,
  `DANHGIA` TEXT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_CTPX_SANPHAM1_idx` (`SANPHAM` ASC) VISIBLE,
  INDEX `fk_CTDDH_DONDATHANG1_idx` (`MADDH` ASC) VISIBLE,
  CONSTRAINT `fk_CTPX_SANPHAM10`
    FOREIGN KEY (`SANPHAM`)
    REFERENCES `KINHDOANHIOT`.`SANPHAM` (`ID`),
  CONSTRAINT `fk_CTDDH_DONDATHANG1`
    FOREIGN KEY (`MADDH`)
    REFERENCES `KINHDOANHIOT`.`DONDATHANG` (`MADDH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHDOANHIOT`.`GIOHANG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHDOANHIOT`.`GIOHANG` ;

CREATE TABLE IF NOT EXISTS `KINHDOANHIOT`.`GIOHANG` (
  `SANPHAM` BIGINT NOT NULL,
  `MAKH` BIGINT NOT NULL,
  `SOLUONG` INT NOT NULL DEFAULT '0',
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID`),
  INDEX `fk_CTPX_SANPHAM1_idx` (`SANPHAM` ASC) VISIBLE,
  INDEX `fk_GIOHANG_KHACHHANG1_idx` (`MAKH` ASC) VISIBLE,
  CONSTRAINT `fk_CTPX_SANPHAM100`
    FOREIGN KEY (`SANPHAM`)
    REFERENCES `KINHDOANHIOT`.`SANPHAM` (`ID`),
  CONSTRAINT `fk_GIOHANG_KHACHHANG1`
    FOREIGN KEY (`MAKH`)
    REFERENCES `KINHDOANHIOT`.`KHACHHANG` (`MAKH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

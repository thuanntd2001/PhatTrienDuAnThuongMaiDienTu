-- MySQL Script generated by MySQL Workbench
-- Sat 11 Feb 2023 07:45:14 PM +07
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `mydb` ;

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
-- -----------------------------------------------------
-- Schema KINHGDOANHIOT
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `KINHGDOANHIOT` ;

-- -----------------------------------------------------
-- Schema KINHGDOANHIOT
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `KINHGDOANHIOT` ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`NHAN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`NHAN` ;

CREATE TABLE IF NOT EXISTS `mydb`.`NHAN` (
  `ID` BIGINT NOT NULL,
  `TENNHAN` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`ID`));


-- -----------------------------------------------------
-- Table `mydb`.`TUKHOA`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`TUKHOA` ;

CREATE TABLE IF NOT EXISTS `mydb`.`TUKHOA` (
  `ID` BIGINT NOT NULL,
  `TENTUKHOA` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`ID`));


-- -----------------------------------------------------
-- Table `mydb`.`TUKHOA_NHAN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`TUKHOA_NHAN` ;

CREATE TABLE IF NOT EXISTS `mydb`.`TUKHOA_NHAN` (
  `TUKHOA_TEN` INT NOT NULL,
  `NHAN_ID` BIGINT NOT NULL,
  `ID` BIGINT NOT NULL,
  INDEX `fk_TUKHOA_has_NHAN_NHAN1_idx` (`NHAN_ID` ASC) VISIBLE,
  INDEX `fk_TUKHOA_has_NHAN_TUKHOA_idx` (`TUKHOA_TEN` ASC) VISIBLE,
  PRIMARY KEY (`ID`),
  CONSTRAINT `fk_TUKHOA_has_NHAN_TUKHOA`
    FOREIGN KEY (`TUKHOA_TEN`)
    REFERENCES `mydb`.`TUKHOA` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_TUKHOA_has_NHAN_NHAN1`
    FOREIGN KEY (`NHAN_ID`)
    REFERENCES `mydb`.`NHAN` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`LOAISP`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`LOAISP` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`LOAISP` (
  `ID` VARCHAR(10) NOT NULL,
  `TENLOAI` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`SANPHAM`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`SANPHAM` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`SANPHAM` (
  `ID` VARCHAR(10) NOT NULL,
  `TEN` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `LOAI` VARCHAR(10) NOT NULL,
  `GIA` INT NOT NULL,
  `DONVITINH` VARCHAR(45) NOT NULL DEFAULT 'CÃ¡i',
  `SOLUONGTON` INT NOT NULL DEFAULT 0,
  PRIMARY KEY (`ID`),
  INDEX `FK_THUCDON_LOAITHUCUONG` (`LOAI` ASC) VISIBLE,
  CONSTRAINT `FK_THUCDON_LOAITHUCUONG`
    FOREIGN KEY (`LOAI`)
    REFERENCES `KINHGDOANHIOT`.`LOAISP` (`ID`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `mydb`.`NHAN_SANPHAM`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`NHAN_SANPHAM` ;

CREATE TABLE IF NOT EXISTS `mydb`.`NHAN_SANPHAM` (
  `NHAN_ID` INT NOT NULL,
  `SANPHAM_ID` VARCHAR(10) NOT NULL,
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID`),
  INDEX `fk_NHAN_has_SANPHAM_SANPHAM1_idx` (`SANPHAM_ID` ASC) VISIBLE,
  INDEX `fk_NHAN_has_SANPHAM_NHAN1_idx` (`NHAN_ID` ASC) VISIBLE,
  CONSTRAINT `fk_NHAN_has_SANPHAM_NHAN1`
    FOREIGN KEY (`NHAN_ID`)
    REFERENCES `mydb`.`NHAN` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_NHAN_has_SANPHAM_SANPHAM1`
    FOREIGN KEY (`SANPHAM_ID`)
    REFERENCES `KINHGDOANHIOT`.`SANPHAM` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table `mydb`.`PHIEUNHAP`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`PHIEUNHAP` ;

CREATE TABLE IF NOT EXISTS `mydb`.`PHIEUNHAP` (
  `MAPN` INT NOT NULL,
  `NHACC` VARCHAR(45) NOT NULL DEFAULT 0,
  `MANV` VARCHAR(255) NOT NULL,
  `NGAY` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`MAPN`));


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`NHANVIEN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`NHANVIEN` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`NHANVIEN` (
  `MANV` BIGINT NOT NULL AUTO_INCREMENT,
  `HOTEN` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `NGAYSINH` DATE NOT NULL,
  `GIOITINH` BIT(1) NOT NULL DEFAULT b'1',
  `LUONG` INT NOT NULL,
  `SDT` VARCHAR(10) NOT NULL,
  `CMND` VARCHAR(15) NOT NULL,
  `DIACHI` VARCHAR(50) CHARACTER SET 'utf8mb3' NULL DEFAULT NULL,
  `NGAYVAOLAM` DATE NOT NULL DEFAULT curdate(),
  `TRANGTHAI` INT NOT NULL DEFAULT b'0' COMMENT '1 hoat dong\n0 ban\n',
  PRIMARY KEY (`MANV`))
ENGINE = InnoDB
AUTO_INCREMENT = 25
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`KHACHHANG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`KHACHHANG` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`KHACHHANG` (
  `MAKH` BIGINT NOT NULL AUTO_INCREMENT,
  `HOTEN` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `NGAYSINH` DATE NOT NULL,
  `GIOITINH` BIT(1) NOT NULL DEFAULT b'1',
  `SDT` VARCHAR(10) NOT NULL,
  `DIACHI` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL,
  `TRANGTHAI` INT NOT NULL DEFAULT 1 COMMENT '1 Hoat dong\n0 BAN\n',
  PRIMARY KEY (`MAKH`))
ENGINE = InnoDB
AUTO_INCREMENT = 25
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`DONDATHANG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`DONDATHANG` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`DONDATHANG` (
  `MADDH` BIGINT NOT NULL AUTO_INCREMENT,
  `NGAYTHUCHIEN` DATETIME NOT NULL DEFAULT curdate(),
  `NVXACNHAN` BIGINT NULL,
  `TINHTRANG` INT NOT NULL DEFAULT '0' COMMENT '0 dang cho xac nhan\n1 da xac nhan\n2 dang chuan bi hang\n3 dang van chuyen\n4 giao hang thanh cong \n-1 da huy\n-2 doi tra\n',
  `MAKH` BIGINT NOT NULL,
  PRIMARY KEY (`MADDH`),
  INDEX `FK_HOADON_NHANVIEN` (`NVXACNHAN` ASC) VISIBLE,
  INDEX `fk_DONDATHANG_KHACHHANG1_idx` (`MAKH` ASC) VISIBLE,
  CONSTRAINT `FK_HOADON_NHANVIEN`
    FOREIGN KEY (`NVXACNHAN`)
    REFERENCES `KINHGDOANHIOT`.`NHANVIEN` (`MANV`)
    ON UPDATE RESTRICT,
  CONSTRAINT `fk_DONDATHANG_KHACHHANG1`
    FOREIGN KEY (`MAKH`)
    REFERENCES `KINHGDOANHIOT`.`KHACHHANG` (`MAKH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 58
DEFAULT CHARACTER SET = utf8mb4;


-- -----------------------------------------------------
-- Table `mydb`.`PHIEUXUAT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`PHIEUXUAT` ;

CREATE TABLE IF NOT EXISTS `mydb`.`PHIEUXUAT` (
  `MAPX` INT NOT NULL,
  `MANV` BIGINT NOT NULL DEFAULT 0,
  `NGAY` DATE NOT NULL,
  `MADDH` BIGINT NOT NULL,
  PRIMARY KEY (`MAPX`),
  INDEX `fk_PHIEUXUAT_DONDATHANG1_idx` (`MADDH` ASC) VISIBLE,
  CONSTRAINT `fk_PHIEUXUAT_DONDATHANG1`
    FOREIGN KEY (`MADDH`)
    REFERENCES `KINHGDOANHIOT`.`DONDATHANG` (`MADDH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table `mydb`.`CTPN`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`CTPN` ;

CREATE TABLE IF NOT EXISTS `mydb`.`CTPN` (
  `MAPN` INT NOT NULL,
  `SANPHAM` VARCHAR(10) NOT NULL,
  `SOLUONG` INT NOT NULL,
  `DONGIA` INT NOT NULL,
  `ID` BIGINT NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_CTPN_PHIEUNHAP1_idx` (`MAPN` ASC) VISIBLE,
  INDEX `fk_CTPN_SANPHAM1_idx` (`SANPHAM` ASC) VISIBLE,
  CONSTRAINT `fk_CTPN_PHIEUNHAP1`
    FOREIGN KEY (`MAPN`)
    REFERENCES `mydb`.`PHIEUNHAP` (`MAPN`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CTPN_SANPHAM1`
    FOREIGN KEY (`SANPHAM`)
    REFERENCES `KINHGDOANHIOT`.`SANPHAM` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


-- -----------------------------------------------------
-- Table `mydb`.`CTPX`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `mydb`.`CTPX` ;

CREATE TABLE IF NOT EXISTS `mydb`.`CTPX` (
  `MAPX` INT NOT NULL,
  `SANPHAM` VARCHAR(10) NOT NULL,
  `SOLUONG` INT NOT NULL DEFAULT 0,
  `DONGIA` VARCHAR(45) NOT NULL,
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID`),
  INDEX `fk_CTPX_SANPHAM1_idx` (`SANPHAM` ASC) VISIBLE,
  CONSTRAINT `fk_CTPX_PHIEUXUAT1`
    FOREIGN KEY (`MAPX`)
    REFERENCES `mydb`.`PHIEUXUAT` (`MAPX`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CTPX_SANPHAM1`
    FOREIGN KEY (`SANPHAM`)
    REFERENCES `KINHGDOANHIOT`.`SANPHAM` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

USE `KINHGDOANHIOT` ;

-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`CHITIETDDH`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`CHITIETDDH` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`CHITIETDDH` (
  `MADDH` BIGINT NOT NULL,
  `MASP` VARCHAR(10) NOT NULL,
  `SOLUONG` INT NOT NULL,
  `TONGTIEN` INT NOT NULL DEFAULT '0',
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `NONCLUSTERED` (`MADDH` ASC, `MASP` ASC) VISIBLE,
  INDEX `FK_CHITIETHD_THUCDON` (`MASP` ASC) VISIBLE,
  CONSTRAINT `FK_CHITIETHD_HOADON`
    FOREIGN KEY (`MADDH`)
    REFERENCES `KINHGDOANHIOT`.`DONDATHANG` (`MADDH`)
    ON DELETE RESTRICT
    ON UPDATE RESTRICT,
  CONSTRAINT `FK_CHITIETHD_THUCDON`
    FOREIGN KEY (`MASP`)
    REFERENCES `KINHGDOANHIOT`.`SANPHAM` (`ID`)
    ON UPDATE CASCADE)
ENGINE = InnoDB
AUTO_INCREMENT = 52
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`CHUCVU`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`CHUCVU` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`CHUCVU` (
  `ID` BIGINT NOT NULL AUTO_INCREMENT,
  `TENCHUCVU` VARCHAR(30) CHARACTER SET 'utf8mb3' NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB
AUTO_INCREMENT = 7
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`USER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`USER` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`USER` (
  `USERNAME` VARCHAR(20) NOT NULL,
  `PASSWD` VARCHAR(50) NOT NULL,
  `MANV` BIGINT NOT NULL,
  `ROLEID` BIGINT NOT NULL,
  `STATUS` INT NOT NULL,
  `EMAIL` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL DEFAULT 'n19dccn000@studen.ptithcm.edu.vn',
  `ICON` VARCHAR(50) CHARACTER SET 'utf8mb3' NOT NULL DEFAULT 'lo_highland.png',
  `NHANVIEN_MANV` BIGINT NULL,
  `KHACHHANG_MAKH` BIGINT NULL,
  INDEX `FK_USERTB_CHUCVU` (`ROLEID` ASC) VISIBLE,
  INDEX `FK_USERTB_NHANVIEN` (`MANV` ASC) VISIBLE,
  PRIMARY KEY (`USERNAME`),
  INDEX `fk_USER_NHANVIEN1_idx` (`NHANVIEN_MANV` ASC) VISIBLE,
  INDEX `fk_USER_KHACHHANG1_idx` (`KHACHHANG_MAKH` ASC) VISIBLE,
  CONSTRAINT `FK_USERTB_CHUCVU`
    FOREIGN KEY (`ROLEID`)
    REFERENCES `KINHGDOANHIOT`.`CHUCVU` (`ID`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_USER_NHANVIEN1`
    FOREIGN KEY (`NHANVIEN_MANV`)
    REFERENCES `KINHGDOANHIOT`.`NHANVIEN` (`MANV`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_USER_KHACHHANG1`
    FOREIGN KEY (`KHACHHANG_MAKH`)
    REFERENCES `KINHGDOANHIOT`.`KHACHHANG` (`MAKH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


-- -----------------------------------------------------
-- Table `KINHGDOANHIOT`.`GIOHANG`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `KINHGDOANHIOT`.`GIOHANG` ;

CREATE TABLE IF NOT EXISTS `KINHGDOANHIOT`.`GIOHANG` (
  `SANPHAM` VARCHAR(10) NOT NULL,
  `MAKH` BIGINT NOT NULL,
  `SOLUONG` INT NOT NULL,
  `TONGTIEN` INT NOT NULL DEFAULT '0',
  `ID` BIGINT NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_CHITIETDDH_copy1_KHACHHANG1_idx` (`MAKH` ASC) VISIBLE,
  INDEX `fk_CHITIETDDH_copy1_SANPHAM1_idx` (`SANPHAM` ASC) VISIBLE,
  CONSTRAINT `fk_CHITIETDDH_copy1_KHACHHANG1`
    FOREIGN KEY (`MAKH`)
    REFERENCES `KINHGDOANHIOT`.`KHACHHANG` (`MAKH`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CHITIETDDH_copy1_SANPHAM1`
    FOREIGN KEY (`SANPHAM`)
    REFERENCES `KINHGDOANHIOT`.`SANPHAM` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB
AUTO_INCREMENT = 52
DEFAULT CHARACTER SET = utf8mb4
COLLATE = utf8mb4_0900_ai_ci;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
